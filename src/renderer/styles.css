@tailwind base;
@tailwind components;
@tailwind utilities;

/* App drag region for title bar */
.app-drag {
  -webkit-app-region: drag;
}

/* Command bar button styles */
.cmd-btn {
  @apply px-2 py-1 rounded text-gray-300 hover:bg-toolbar-hover hover:text-white transition-colors text-sm font-medium;
}

.cmd-btn:active {
  @apply bg-gray-600;
}

/* Tab styles */
.tab {
  @apply flex items-center gap-2 px-4 py-2 bg-tab-bg border-r border-tab-border text-gray-400 hover:bg-tab-hover cursor-pointer max-w-48 min-w-0;
}

.tab.active {
  @apply bg-tab-active text-white;
}

.tab-title {
  @apply truncate text-sm;
}

.tab-close {
  @apply opacity-0 hover:opacity-100 text-gray-500 hover:text-white rounded p-0.5 transition-opacity;
}

.tab:hover .tab-close,
.tab.active .tab-close {
  @apply opacity-100;
}

.tab-dirty {
  @apply w-2 h-2 rounded-full bg-blue-400 flex-shrink-0;
}

/* CSS Custom Properties for user settings - applied to root for rem calculation */
:root {
  --editor-font-size: 14px;
  --editor-font-family: monospace;
  --editor-fg-color: #e5e5e5;
  --editor-bg-color: #1e1e1e;
  --editor-heading-color: #79c0ff;
  --editor-table-header-bg: #2d333b;
}

/* Editor styles */
#editor-container {
  background-color: var(--editor-bg-color, #1e1e1e);
}

#editor {
  tab-size: 4;
  line-height: 1.6;
  font-size: 1rem;
  font-family: var(--editor-font-family);
  color: var(--editor-fg-color, #e5e5e5);
  background-color: var(--editor-bg-color, #1e1e1e);
}

#editor::placeholder {
  @apply text-gray-600;
}

/* Scrollbar styles */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  @apply bg-transparent;
}

::-webkit-scrollbar-thumb {
  @apply bg-gray-600 rounded-full;
}

::-webkit-scrollbar-thumb:hover {
  @apply bg-gray-500;
}

/* Preview prose styles - using rem for proportional scaling from root font-size */
.prose {
  @apply text-gray-800;
  line-height: 1.6;
  font-size: 1rem;
}

.prose h1 {
  font-size: 2rem;
  @apply font-bold pb-2 border-b border-gray-200;
  margin-bottom: 1rem;
}

.prose h2 {
  font-size: 1.5rem;
  @apply font-bold pb-1 border-b border-gray-100;
  margin-bottom: 0.75rem;
}

.prose h3 {
  font-size: 1.25rem;
  @apply font-semibold;
  margin-bottom: 0.5rem;
}

.prose h4 {
  font-size: 1.125rem;
  @apply font-semibold;
  margin-bottom: 0.5rem;
}

.prose p {
  font-size: 1rem;
  @apply leading-relaxed;
  margin-bottom: 1rem;
}

.prose a {
  @apply text-blue-600 hover:underline;
}

.prose ul,
.prose ol {
  font-size: 1rem;
  margin-bottom: 1rem;
  padding-left: 1.5rem;
}

.prose ul {
  @apply list-disc;
}

.prose ol {
  @apply list-decimal;
}

.prose li {
  margin-bottom: 0.25rem;
}

.prose blockquote {
  font-size: 1rem;
  @apply border-l-4 border-gray-300 italic text-gray-600;
  padding-left: 1rem;
  margin: 1rem 0;
}

.prose code {
  font-size: 0.875rem;
  @apply bg-gray-100 rounded font-mono text-gray-800;
  padding: 0.125rem 0.375rem;
}

.prose pre {
  font-size: 0.875rem;
  @apply bg-gray-900 text-gray-100 rounded-lg overflow-x-auto;
  padding: 1rem;
  margin: 1rem 0;
}

.prose pre code {
  @apply bg-transparent p-0 text-inherit;
  font-size: inherit;
}

.prose img {
  @apply max-w-full h-auto rounded;
  margin: 1rem 0;
}

.prose hr {
  @apply border-gray-200;
  margin: 2rem 0;
}

.prose table {
  font-size: 1rem;
  @apply w-full border-collapse;
  margin-bottom: 1rem;
}

.prose th,
.prose td {
  @apply border border-gray-300 text-left;
  padding: 0.5rem 0.75rem;
}

.prose th {
  @apply bg-gray-50 font-semibold;
}

/* Highlight.js overrides for code blocks */
.hljs {
  @apply bg-transparent;
}

/* Milkdown WYSIWYG editor styles */
#preview .milkdown {
  @apply h-full;
}

#preview .editor {
  @apply h-full outline-none;
}

#preview .ProseMirror {
  @apply h-full outline-none;
  font-size: 1rem;
}

#preview .ProseMirror:focus {
  @apply outline-none;
}

/* Apply settings to preview container */
#preview-container {
  font-family: var(--editor-font-family);
  background-color: var(--editor-bg-color);
  color: var(--editor-fg-color);
}

#preview-container .prose {
  font-size: 1rem;
  color: inherit;
  font-family: inherit;
}

#preview-container .prose h1,
#preview-container .prose h2,
#preview-container .prose h3,
#preview-container .prose h4,
#preview-container .prose h5,
#preview-container .prose h6 {
  color: var(--editor-heading-color);
}

#preview-container .prose th {
  background-color: var(--editor-table-header-bg);
}

#preview-container .ProseMirror {
  color: inherit;
  background-color: inherit;
  font-family: inherit;
}

/* Make the preview container fill available space when Milkdown is active */
#preview-container:not(.hidden) #preview {
  @apply h-full;
}


/* Tab context menu */
.tab-context-menu {
  @apply fixed bg-gray-800 border border-gray-600 rounded-lg shadow-xl py-1 z-50 min-w-32;
}

.tab-context-menu-item {
  @apply px-3 py-1.5 text-sm text-gray-200 hover:bg-gray-700 cursor-pointer;
}

.tab-context-menu-item:first-child {
  @apply rounded-t;
}

.tab-context-menu-item:last-child {
  @apply rounded-b;
}

/* Status bar */
.status-bar {
  @apply flex items-center gap-2 px-4 py-1 bg-tab-bg border-t border-tab-border text-gray-400 text-xs flex-shrink-0;
}

.status-separator {
  @apply text-gray-600;
}

/* Find bar */
.find-bar {
  @apply bg-toolbar-bg border-b border-toolbar-border px-2 py-1 flex-shrink-0;
}

.find-bar-row {
  @apply flex items-center gap-2;
}

.find-bar-row + .find-bar-row {
  @apply mt-1;
}

.find-input {
  @apply flex-1 bg-gray-700 text-white rounded px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500;
}

.find-match-count {
  @apply text-xs text-gray-400 min-w-16 text-right;
}

.find-btn {
  @apply p-1 rounded text-gray-400 hover:text-white hover:bg-gray-600 transition-colors;
}

.find-btn-text {
  @apply px-2 py-1 rounded text-sm text-gray-300 hover:text-white hover:bg-gray-600 transition-colors;
}

/* Split view */
.split-view {
  @apply flex-row;
}

.split-view #editor-container {
  flex: none;
  overflow: hidden;
}

.split-view #preview-container {
  flex: none;
  overflow: auto;
}

/* Resize handle for split view */
.split-resize-handle {
  @apply flex-shrink-0 cursor-col-resize bg-gray-700 hover:bg-blue-500 transition-colors;
  width: 4px;
}

.split-resize-handle:active {
  @apply bg-blue-600;
}

/* Outline panel */
.outline-panel {
  @apply w-64 bg-gray-800 border-r border-gray-700 flex flex-col flex-shrink-0 overflow-hidden;
}

.outline-panel.hidden {
  display: none !important;
}

.outline-header {
  @apply flex items-center justify-between px-3 py-2 border-b border-gray-700;
}

.outline-title {
  @apply text-sm font-medium text-gray-300;
}

.outline-close-btn {
  @apply p-1 text-gray-400 hover:text-white rounded hover:bg-gray-700;
}

.outline-content {
  @apply flex-1 overflow-auto px-2 py-2;
}

.outline-empty {
  @apply text-gray-500 text-sm text-center py-4;
}

.outline-list {
  @apply list-none m-0 p-0;
}

.outline-list .outline-list {
  @apply ml-4;
}

.outline-item {
  @apply my-0.5;
}

.outline-item.collapsed > .outline-list {
  @apply hidden;
}

.outline-item.collapsed .outline-toggle svg {
  transform: rotate(-90deg);
}

.outline-item-wrapper {
  @apply flex items-center gap-1;
}

.outline-toggle {
  @apply p-0.5 text-gray-500 hover:text-gray-300 rounded;
}

.outline-toggle svg {
  @apply transition-transform;
}

.outline-spacer {
  @apply w-4;
}

.outline-link {
  @apply text-sm text-gray-400 hover:text-white no-underline truncate block py-0.5 px-1 rounded hover:bg-gray-700;
}

.outline-link.level-1 {
  @apply font-semibold text-gray-200;
}

.outline-link.level-2 {
  @apply font-medium text-gray-300;
}

.outline-link.level-3 {
  @apply text-gray-400;
}

/* Focus mode */
.focus-mode #title-bar-drag,
.focus-mode #tab-bar,
.focus-mode #command-bar,
.focus-mode #status-bar,
.focus-mode #find-bar,
.focus-mode #outline-panel {
  @apply hidden;
}

.focus-mode #content {
  @apply h-screen;
}

.focus-mode #editor-container,
.focus-mode #preview-container {
  @apply h-full;
}

/* Table dialog */
.table-preview-container {
  @apply bg-gray-700 rounded p-2;
}

.table-preview-grid {
  @apply w-full border-collapse;
}

.table-preview-grid th,
.table-preview-grid td {
  @apply p-1;
}

.table-cell-input {
  @apply w-full bg-gray-600 text-white rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500;
  min-width: 80px;
}

.table-header-input {
  @apply bg-gray-500 font-medium;
}

/* CodeMirror container */
.cm-container {
  @apply h-full overflow-hidden;
}

.cm-container .cm-editor {
  height: 100%;
}

.cm-container .cm-scroller {
  overflow: auto !important;
}
