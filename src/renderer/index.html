<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src * data: blob:"
    />
    <title>EasyMarkdown</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body class="bg-editor-bg text-editor-text font-sans h-screen flex flex-col overflow-hidden">
    <!-- Title bar drag region (macOS only) -->
    <div id="title-bar-drag" class="h-7 bg-tab-bg flex-shrink-0 app-drag"></div>

    <!-- Tab bar -->
    <div id="tab-bar" class="flex bg-tab-bg border-b border-tab-border flex-shrink-0 overflow-x-auto">
      <div id="tabs" class="flex min-w-0 flex-1"></div>
      <button
        id="new-tab-btn"
        class="px-3 py-2 text-gray-400 hover:text-white hover:bg-tab-hover flex-shrink-0"
        title="New Tab"
      >
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
        </svg>
      </button>
    </div>

    <!-- Command bar -->
    <div id="command-bar" class="flex bg-toolbar-bg border-b border-toolbar-border px-2 py-1 gap-1 flex-shrink-0">
      <button class="cmd-btn" data-format="bold" title="Bold (Cmd+B)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 4h8a4 4 0 014 4 4 4 0 01-4 4H6z" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 12h9a4 4 0 014 4 4 4 0 01-4 4H6z" />
        </svg>
      </button>
      <button class="cmd-btn" data-format="italic" title="Italic (Cmd+I)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 4h4m-2 0v16m-4 0h8" transform="skewX(-10)" />
        </svg>
      </button>
      <div class="w-px bg-toolbar-border mx-1"></div>
      <button class="cmd-btn" data-format="h1" title="Heading 1 (Cmd+1)">H1</button>
      <button class="cmd-btn" data-format="h2" title="Heading 2 (Cmd+2)">H2</button>
      <button class="cmd-btn" data-format="h3" title="Heading 3 (Cmd+3)">H3</button>
      <div class="w-px bg-toolbar-border mx-1"></div>
      <button class="cmd-btn" data-format="code" title="Inline Code (Cmd+`)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
        </svg>
      </button>
      <button class="cmd-btn" data-format="codeblock" title="Code Block (Cmd+Shift+`)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h10M4 18h6" />
        </svg>
      </button>
      <div class="w-px bg-toolbar-border mx-1"></div>
      <button class="cmd-btn" data-format="link" title="Link (Cmd+K)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
        </svg>
      </button>
      <button class="cmd-btn" data-format="image" title="Image">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
        </svg>
      </button>
      <div class="w-px bg-toolbar-border mx-1"></div>
      <button class="cmd-btn" data-format="ul" title="Bulleted List (Cmd+Shift+8)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
      <button class="cmd-btn" data-format="ol" title="Numbered List (Cmd+Shift+7)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 6h13M7 12h13M7 18h13M3 6h.01M3 12h.01M3 18h.01" />
        </svg>
      </button>
      <button class="cmd-btn" data-format="quote" title="Blockquote (Cmd+Shift+.)">
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
          <path d="M4.583 17.321C3.553 16.227 3 15 3 13.011c0-3.5 2.457-6.637 6.03-8.188l.893 1.378c-3.335 1.804-3.987 4.145-4.247 5.621.537-.278 1.24-.375 1.929-.311 1.804.167 3.226 1.648 3.226 3.489a3.5 3.5 0 01-3.5 3.5c-1.073 0-2.099-.49-2.748-1.179zm10 0C13.553 16.227 13 15 13 13.011c0-3.5 2.457-6.637 6.03-8.188l.893 1.378c-3.335 1.804-3.987 4.145-4.247 5.621.537-.278 1.24-.375 1.929-.311 1.804.167 3.226 1.648 3.226 3.489a3.5 3.5 0 01-3.5 3.5c-1.073 0-2.099-.49-2.748-1.179z" />
        </svg>
      </button>
      <div class="w-px bg-toolbar-border mx-1"></div>
      <button class="cmd-btn" data-format="table" title="Insert Table (Cmd+T)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18M10 3v18M14 3v18M3 6a3 3 0 013-3h12a3 3 0 013 3v12a3 3 0 01-3 3H6a3 3 0 01-3-3V6z" />
        </svg>
      </button>
      <div class="flex-1"></div>
      <button
        id="toggle-view-btn"
        class="cmd-btn px-3"
        title="Toggle Preview (Cmd+P)"
      >
        <span id="view-mode-label">Preview</span>
      </button>
    </div>

    <!-- Find bar -->
    <div id="find-bar" class="hidden find-bar">
      <div class="find-bar-row">
        <input
          type="text"
          id="find-input"
          class="find-input"
          placeholder="Find..."
        />
        <span id="find-match-count" class="find-match-count"></span>
        <button id="find-prev" class="find-btn" title="Previous match (Shift+Enter)">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />
          </svg>
        </button>
        <button id="find-next" class="find-btn" title="Next match (Enter)">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <button id="find-close" class="find-btn" title="Close (Escape)">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      <div id="replace-section" class="find-bar-row hidden">
        <input
          type="text"
          id="replace-input"
          class="find-input"
          placeholder="Replace with..."
        />
        <button id="replace-one" class="find-btn-text" title="Replace">
          Replace
        </button>
        <button id="replace-all" class="find-btn-text" title="Replace All">
          All
        </button>
      </div>
    </div>

    <!-- Main content area -->
    <div id="content" class="flex-1 flex overflow-hidden">
      <!-- Outline panel -->
      <div id="outline-panel" class="outline-panel hidden">
        <div class="outline-header">
          <span class="outline-title">Outline</span>
          <button id="outline-close" class="outline-close-btn" title="Close">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div id="outline-content" class="outline-content"></div>
      </div>

      <!-- Editor -->
      <div id="editor-container" class="flex-1 flex flex-col overflow-hidden">
        <textarea
          id="editor"
          class="flex-1 bg-editor-bg text-editor-text font-mono text-sm p-4 resize-none outline-none border-none"
          placeholder="Start writing markdown..."
          spellcheck="false"
        ></textarea>
      </div>

      <!-- Resize handle for split view -->
      <div id="split-resize-handle" class="split-resize-handle hidden"></div>

      <!-- Preview -->
      <div
        id="preview-container"
        class="flex-1 overflow-auto p-6 bg-white text-gray-900 hidden"
      >
        <div id="preview" class="prose prose-sm max-w-none"></div>
      </div>
    </div>

    <!-- Status bar -->
    <div id="status-bar" class="status-bar hidden">
      <span id="status-word-count">0 words</span>
      <span class="status-separator">|</span>
      <span id="status-char-count">0 characters</span>
      <span class="status-separator">|</span>
      <span id="status-cursor-pos">Ln 1, Col 1</span>
    </div>

    <!-- Empty state -->
    <div id="empty-state" class="hidden flex-1 flex items-center justify-center text-gray-500">
      <div class="text-center">
        <p class="text-lg mb-2">No files open</p>
        <p class="text-sm">Press <kbd class="px-2 py-1 bg-gray-700 rounded">Cmd+N</kbd> to create a new file</p>
        <p class="text-sm">or <kbd class="px-2 py-1 bg-gray-700 rounded">Cmd+O</kbd> to open a file</p>
      </div>
    </div>

    <!-- Image Dialog -->
    <div id="image-dialog" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-gray-800 rounded-lg shadow-xl w-96 p-6">
        <h3 class="text-lg font-semibold text-white mb-4">Insert Image</h3>

        <div class="space-y-4">
          <!-- Alt text -->
          <div>
            <label class="block text-sm text-gray-300 mb-1">Alt Text</label>
            <input
              type="text"
              id="image-alt"
              class="w-full bg-gray-700 text-white rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="Image description"
            />
          </div>

          <!-- Source type tabs -->
          <div class="flex border-b border-gray-600">
            <button
              id="image-tab-url"
              class="px-4 py-2 text-sm font-medium text-blue-400 border-b-2 border-blue-400"
            >
              URL
            </button>
            <button
              id="image-tab-file"
              class="px-4 py-2 text-sm font-medium text-gray-400 hover:text-gray-300"
            >
              Local File
            </button>
          </div>

          <!-- URL input -->
          <div id="image-url-section">
            <input
              type="text"
              id="image-url"
              class="w-full bg-gray-700 text-white rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="https://example.com/image.png"
            />
          </div>

          <!-- File input -->
          <div id="image-file-section" class="hidden">
            <div class="flex gap-2">
              <input
                type="text"
                id="image-file-path"
                class="flex-1 bg-gray-700 text-white rounded px-3 py-2 text-sm focus:outline-none"
                placeholder="No file selected"
                readonly
              />
              <button
                id="image-file-browse"
                class="px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded text-sm"
              >
                Browse
              </button>
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="flex justify-end gap-3 mt-6">
          <button
            id="image-cancel"
            class="px-4 py-2 text-gray-300 hover:text-white text-sm"
          >
            Cancel
          </button>
          <button
            id="image-insert"
            class="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded text-sm"
          >
            Insert
          </button>
        </div>
      </div>
    </div>

    <!-- Table Dialog -->
    <div id="table-dialog" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-gray-800 rounded-lg shadow-xl w-auto max-w-2xl p-6">
        <h3 class="text-lg font-semibold text-white mb-4">Insert Table</h3>

        <div class="space-y-4">
          <!-- Size inputs -->
          <div class="flex gap-4">
            <div>
              <label class="block text-sm text-gray-300 mb-1">Rows</label>
              <input
                type="number"
                id="table-rows"
                class="w-20 bg-gray-700 text-white rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                value="3"
                min="1"
                max="10"
              />
            </div>
            <div>
              <label class="block text-sm text-gray-300 mb-1">Columns</label>
              <input
                type="number"
                id="table-cols"
                class="w-20 bg-gray-700 text-white rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                value="3"
                min="1"
                max="10"
              />
            </div>
          </div>

          <!-- Table preview/editor -->
          <div>
            <label class="block text-sm text-gray-300 mb-2">Table Content</label>
            <div id="table-preview" class="table-preview-container overflow-auto max-h-64">
              <!-- Dynamic table will be inserted here -->
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="flex justify-end gap-3 mt-6">
          <button
            id="table-cancel"
            class="px-4 py-2 text-gray-300 hover:text-white text-sm"
          >
            Cancel
          </button>
          <button
            id="table-insert"
            class="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded text-sm"
          >
            Insert Table
          </button>
        </div>
      </div>
    </div>

    <!-- Settings Dialog -->
    <div id="settings-dialog" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-gray-800 rounded-lg shadow-xl w-96 p-6">
        <h3 class="text-lg font-semibold text-white mb-4">Settings</h3>

        <div class="space-y-4">
          <!-- Font Size -->
          <div>
            <label class="block text-sm text-gray-300 mb-1">Font Size</label>
            <select
              id="settings-font-size"
              class="w-full bg-gray-700 text-white rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
            >
              <option value="12">12px</option>
              <option value="14">14px</option>
              <option value="16">16px</option>
              <option value="18">18px</option>
              <option value="20">20px</option>
              <option value="24">24px</option>
            </select>
          </div>

          <!-- Font Family -->
          <div>
            <label class="block text-sm text-gray-300 mb-1">Font Family</label>
            <select
              id="settings-font-family"
              class="w-full bg-gray-700 text-white rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
            >
              <option value="monospace" style="font-family: monospace">Monospace</option>
              <option value="system-ui, -apple-system, sans-serif" style="font-family: system-ui, -apple-system, sans-serif">System</option>
              <option value="sans-serif" style="font-family: sans-serif">Sans-serif</option>
              <option value="serif" style="font-family: serif">Serif</option>
            </select>
          </div>

          <!-- Theme Colors Section -->
          <div class="border-t border-gray-600 pt-4">
            <label class="block text-sm text-gray-400 mb-3 font-medium">Theme Colors</label>

            <!-- Foreground Color -->
            <div class="mb-3">
              <label class="block text-sm text-gray-300 mb-1">Text Color</label>
              <div class="flex gap-2">
                <select
                  id="settings-fg-preset"
                  class="flex-1 bg-gray-700 text-white rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                  <option value="custom">Custom</option>
                </select>
                <input
                  type="color"
                  id="settings-fg-color"
                  class="w-12 h-9 bg-gray-700 rounded border-0 cursor-pointer hidden"
                  value="#e5e5e5"
                />
              </div>
            </div>

            <!-- Background Color -->
            <div class="mb-3">
              <label class="block text-sm text-gray-300 mb-1">Background Color</label>
              <div class="flex gap-2">
                <select
                  id="settings-bg-preset"
                  class="flex-1 bg-gray-700 text-white rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                  <option value="custom">Custom</option>
                </select>
                <input
                  type="color"
                  id="settings-bg-color"
                  class="w-12 h-9 bg-gray-700 rounded border-0 cursor-pointer hidden"
                  value="#1e1e1e"
                />
              </div>
            </div>

            <!-- Heading Color -->
            <div class="mb-3">
              <label class="block text-sm text-gray-300 mb-1">Heading Color</label>
              <div class="flex gap-2">
                <select
                  id="settings-heading-preset"
                  class="flex-1 bg-gray-700 text-white rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                  <option value="custom">Custom</option>
                </select>
                <input
                  type="color"
                  id="settings-heading-color"
                  class="w-12 h-9 bg-gray-700 rounded border-0 cursor-pointer hidden"
                  value="#79c0ff"
                />
              </div>
            </div>

            <!-- Table Header Background -->
            <div class="mb-3">
              <label class="block text-sm text-gray-300 mb-1">Table Header Background</label>
              <div class="flex gap-2">
                <select
                  id="settings-table-header-preset"
                  class="flex-1 bg-gray-700 text-white rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                  <option value="custom">Custom</option>
                </select>
                <input
                  type="color"
                  id="settings-table-header-color"
                  class="w-12 h-9 bg-gray-700 rounded border-0 cursor-pointer hidden"
                  value="#2d333b"
                />
              </div>
            </div>
          </div>

          <!-- Auto-save -->
          <div class="border-t border-gray-600 pt-4">
            <div class="flex items-center gap-3">
              <input
                type="checkbox"
                id="settings-auto-save"
                class="w-4 h-4 rounded bg-gray-700 border-gray-600 focus:ring-blue-500"
              />
              <label for="settings-auto-save" class="text-sm text-gray-300">Enable Auto-save</label>
            </div>
            <div id="auto-save-interval-section" class="mt-2 hidden">
              <label class="block text-sm text-gray-300 mb-1">Save every</label>
              <select
                id="settings-auto-save-interval"
                class="w-full bg-gray-700 text-white rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
              >
                <option value="15">15 seconds</option>
                <option value="30">30 seconds</option>
                <option value="60">1 minute</option>
                <option value="120">2 minutes</option>
                <option value="300">5 minutes</option>
              </select>
            </div>
          </div>

          <!-- Spell Check -->
          <div class="flex items-center gap-3">
            <input
              type="checkbox"
              id="settings-spell-check"
              class="w-4 h-4 rounded bg-gray-700 border-gray-600 focus:ring-blue-500"
            />
            <label for="settings-spell-check" class="text-sm text-gray-300">Enable Spell Check</label>
          </div>
        </div>

        <!-- Actions -->
        <div class="flex justify-between mt-6">
          <button
            id="settings-reset"
            class="px-4 py-2 text-gray-400 hover:text-white text-sm"
          >
            Reset to Defaults
          </button>
          <div class="flex gap-3">
            <button
              id="settings-cancel"
              class="px-4 py-2 text-gray-300 hover:text-white text-sm"
            >
              Cancel
            </button>
            <button
              id="settings-save"
              class="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded text-sm"
            >
              Save
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="renderer.js"></script>
  </body>
</html>
